<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Lista de Arquivos TXT do Google Drive</title>
</head>
<body>
    <h1>Selecione um arquivo TXT</h1>

    <select id="arquivoSelect">
        <option value="">--Selecione--</option>
    </select>

    <h2>Conteúdo do arquivo:</h2>
    <pre id="conteudo"></pre>

    <script>
        const select = document.getElementById('arquivoSelect');
        const conteudo = document.getElementById('conteudo');

        // ID da pasta do Drive
        const folderId = "1UkBjpiabbhcQGbnnzMdDVkby-EKTysl2";

        // URL do Web App do Google Apps Script
        const webAppUrl = "https://script.google.com/macros/s/AKfycbzNFQbteLvWFrv9W3dwPe64Av-XN2uwRXN_1MRORRVJjA3S8U-a-4eyZzRTRll7lejaIA/exec";

        // Buscar lista de arquivos TXT da pasta
        fetch(webAppUrl + "?folderId=" + folderId)
            .then(response => response.json())
            .then(files => {
                files.forEach(file => {
                    const option = document.createElement('option');
                    option.value = file.url;
                    option.textContent = file.name;
                    select.appendChild(option);
                });
            })
            .catch(err => {
                console.error("Erro ao buscar arquivos:", err);
                conteudo.textContent = "Erro ao carregar a lista de arquivos: " + err;
            });

        // Mostrar conteúdo do arquivo selecionado
        select.addEventListener('change', () => {
            const url = select.value;
            if (url) {
                fetch(url)
                    .then(r => r.text())
                    .then(t => { conteudo.textContent = t; })
                    .catch(err => { conteudo.textContent = "Erro ao carregar arquivo: " + err; });
            } else {
                conteudo.textContent = '';
            }
        });
    </script>
</body>
</html>
